<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>LogScrubber</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<style>
  * {
    font-family: roboto slab;
  }

  h1 {
    margin-left: 30px;
    font-size: 40px;
  }
</style>
<body style="background-color: #13202F">
<h1 style="color: #4FCF70;">esb-a-erfurt.test.elex.be</h1>
<input type="text" id="query"><input type="button" value="Search" id="search">
<div id="chart_div" style="margin: 0 auto; display: block; width: 100%; height: 800px;"></div>
<link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
//    <![CDATA[
var client = new XMLHttpRequest();

client.onreadystatechange = function() {
  if (client.readyState == XMLHttpRequest.DONE) {

    var chartData = [['Tag', 'Average']];
    var tags = client.responseText;

    google.charts.load('current', {packages: ['corechart', 'bar']});
    google.charts.setOnLoadCallback(drawBasic);

    function drawBasic() {
      var chart = new google.visualization.BarChart(document.getElementById('chart_div'));

      var data = google.visualization.arrayToDataTable(chartData);

      var options = {
        title: '2016-03-01 12:00 to 2016-03-01 12:30',
        titleTextStyle: {
          fontSize: '30',
          color: '#F1EAE5'
        },
        backgroundColor: '#13202F',
        colors: ['#5182BD'],
        chartArea: {
          width: '60%'
        },
        legend: 'none',
        hAxis: {
          textStyle: {
            color: '#FFA661'
          },
          title: 'Seconds',
          titleTextStyle: {
            color: '#FFA661'
          },
          minValue: 0
        },
        vAxis: {
          textStyle: {
            color: '#FFA661'
          }
        }
      };

      var el = document.getElementById("search");
      el.addEventListener("click", function () {
        var queryString = document.getElementById("query").value;
        filter(queryString);
      });

      function filter(substring) {
        chartData = [['Tag', 'Average']];
        for (var i in tags) {
          if (tags[i][0].indexOf(substring) > -1)
            chartData.push(tags[i]);
        }
        data = google.visualization.arrayToDataTable(chartData);
        chart.draw(data, options);
      }

      filter("");
      chart.draw(data, options);
    }
  }
};
  client.open("GET", "http://localhost:8090/json", true);
  client.send(null);
//    ]]>
</script>
</body>
</html>
